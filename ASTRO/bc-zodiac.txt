TODO: rewrite for modified version

I wrote
https://github.com/barrycarter/bcapps/blob/6d6801b590a9d3ab3dc4bc1906e37ab522df07f1/ASTRO/bc-zodiac.c
to solve this. I've tweaked bc-zodiac.c slightly since then, so you'll
need the exact link above (not the most recent version of bc-zodiac.c)
to confirm/replicate my results. In the directory
https://github.com/barrycarter/bcapps/blob/master/ASTRO/

  - The file "houses.txt.bz2" contains a list of all house changes for
  now +- ~15000 years in a mostly-English-readable format.

  - The file "house-states.txt.bz2" is a list of all "horoscopes"
  (house states for all planets) in machine readable format for the
  same period. Please see
  https://github.com/barrycarter/bcapps/blob/master/ASTRO/bc-zodiac.txt
  (which also contains the text of this answer) for details on how to
  read this file.

Important caveats below, but first, some notes:

  - You'll notice that lines like:

`-13199-APR-02 09:39 SUN ENTERS ARIES PROGRADE -478679466007.210083 S0`

suggest the vernal equinox was on April 2nd about 15000 years ago (of
course, no one actually used our calendar back then), which seems a
bit off. Further, you'll notice:

`17191-FEB-23 00:12 SUN ENTERS ARIES PROGRADE 480332938365.345520 S0`

suggesting the vernal equinox will occur on February 23rd (about a
month early) 15000 years from now (assuming they continue using our
calendar).




  - In the 11,100,016 days (about 30,391 years) covered, there are
  6,359,881 horoscope changes, for an average horoscope change roughly
  every 1.75 days. Broken down by planet:

    - The moon changes house 4,875,275 times, about once every 2.3 days.

    - Mercury changes house 450,531 times (including retrograde house
    changes), about once every 25 days.

    - Venus changes house 384,969 times (including retrograde), about
    once every 29 days.

    - The Sun comes in third with 364,691 changes, about once every 30
    days. A more exact number is once every 30.4367697585 days. When
    you multiply this by 12, you get 365.2412371020 days, which, as
    expected, is a good estimate of the length of the tropical year
    (the exact value given by
    http://hpiers.obspm.fr/eop-pc/models/constants.html is
    365.242190402, which is 82 seconds different).

    - Mars changes house (including retrograde) 209,501 times, about
    once every 53 days.

    - Jupiter (w/ retrograde) 49,217 times, once every ~225.5 days.

    - Saturn (w/ retrograde) 25,697 times, ~432 days.

  - As expected, most of these house changes (6,283,144) are in the
  forward or "prograde" direction and very few (76,737) are in the
  retrograde direction. Of course, the Sun and Moon always move
  prograde, another reason the prograde number is so large.

  - Since there are 12 houses and 7 planets, it would seem there are
  12^7 = 35,831,808 possible horoscopes. However, there are actually
  only 3,732,480:

    - Since Mercury's greatest elongation is 28 degrees, it must
    remain within one house of the Sun. Given the Sun's house, there
    are only 3 possibilities for Mercury's house (either the Sun's
    house or an adjacent house).

    - Since Venus' greatest elongation is 47 degrees, it must remain
    within two houses of the Sun, so there are only 5 possibilities
    given the Sun's house.

    - Combining these, we see there are 12*12*3*5*12*12*12 or
    3,732,480 possible horoscopes.

  - Of these possibilities there are 2,565,619 (about 69% of the total
  possible) actual horoscopes. Of these,

    - 969,161 horoscopes occur only once

    - The horoscope "4045424" (translated below) occurs 18 times (most
    recently in 1799 and next in 5391), but two others occur 17 times,
    10 appear 16 times, and many appear 15 times. The most frequently
    occurring horoscope is: Sun in Leo, Moon in Aries, Mercury in Leo,
    Venus in Virgo, Mars in Leo, Jupiter in Gemini, Saturn in Leo.

Note that this horoscope is probably only the most frequent because of
how I chose the start and end dates (based on the DE431 ephemeris).

Important caveats:

  - My standard disclaimer: please do not rely on anything I do/post
  anywhere. I can and do make mistakes. Feel free to check my work and
  alert me to mistakes.

  - If you actually want to check my results, you will need to
  download kernels from NASA.

  - Although I give times to the microsecond in some cases, the
  results are nowhere near that accurate:

    - I set the tolerance
    (http://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/cspice/gfstol_c.html)
    to 1 second (the default of 1 microsecond doesn't work across
    large time ranges), so, even theoretically, the results aren't
    accurate to the microsecond.

    - Realistically, even NASA doesn't predict planet positions that
    accurately. They solve differential equations to predict planetary
    positions and then publish an approximation of those
    solutions. The further away we get from today, the less accurate
    these predictions are.

    - We have a pretty good approximation of how the Earth precesses,
    but we can't even predict it accurately more than 2 weeks in the
    future. Since precession affects the location of the first point
    of Aries, this adds another uncertainty.

    - Precession doesn't change the ecliptic itself, but nutation
    does. Again, we don't have a super-accurate model of nutation.

    - The calendar on
    https://cafeastrology.com/astrologyof2017horoscopes.html disagrees
    with my results, even allowing for timezone difference. For
    example, I have:

`2017-JUN-21 09:44 MERCURY ENTERS CANCER PROGRADE 1498038281.695388 13`

whereas they have:

`Jun 21	 4:57 AM	Mercury enters Cancer`

Part of this difference is time zones: I give all times UTC and they
use Eastern Time, including Daylight Saving Time. In June, the
difference between the two is 4 hours, so my result translates to
5:44am, still a discrepancy of about 47 minutes.

In this case, however, I believe my result is more accurate, since I consider
precession between 2000 and 2016.

HORIZONS (which uses DE431mx, slight different from the ephemeris I'm
using) gives the time of crossing as between 09:57 and 09:58, which is
closer to my answer [the fact this exactly 1 hour different from their
time is suspicious, I'm looking into it]

  - I used a "stepsize" of 86400 seconds (1 day), so if a planet
  changed house and then changed back in under a day, my program may
  miss it. Someone w/ more computing power may wish to re-run my
  program with a smaller stepsize.

  - The moon's position varies with your location on Earth. I used a
  geocentric model, giving the moon's position for a theoretical
  observer located at the center of the Earth.

  - The human-readable time in houses.txt.bz2 is the output of the C
  function
  http://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/cspice/timout_c.html
  They are reasonable for current dates, but not necessarily for past
  dates because the Gregorian Reformation of the calendar occurred at
  different times for different countries, and the BCE/CE time system
  didn't exist prior to 1 CE (and probably not even then). For
  precision work, see bc-zodiac.txt for details.

  - As requested, I use "ARIES" to mean the "1st house", ie, the
  constellation that starts at the vernal equinox ("the first point of
  Aries", where the ascending ecliptic meets the celestial equator)
  and ends 30 ecliptic degrees of ecliptic longitude later.

    - This was reasonably accurate in 56 BCE (-55 in stellarium means 56 BCE):

[[239]]

    - But is certainly not true today:

[[237]]

as the vernal equinox is in Pisces and drifts towards Aquarius,
heralding the "Age of Aquarius".

    - In the 30,000+ year period covered by my program, the first
    point of Aries makes a complete circuit (and a bit more) of the
    Zodiac, even ending up in Ophiuchus for a while:

[[238]]

Of course, the constellation boundaries above are those defined by the
IAU. I don't know how (or if) the ancients drew their constellation
boundaries.

NOTE: I wanted to use H.A. Rey's constellation lines, but Stellarium's
constellation boundaries appear to break for Pisces when I do that.

  - I am leaving my old answer below, because NASA is a trusted site
  for astronomers, and WebGeoCalc and HORIZONS are important
  resources. The step-by-step method I show below can help people here
  make their own calculations or help others. I am in no way
  affiliated with NASA or the government of the United States, except
  as a citizen (and even that may change soon).


HOW TO READ houses.txt.bz2
==========================

This file contains a list of all house changes for the 7 major planets
(subject to caveats above) in both English and machine readable
format. The fields are:

  - Note: If you are programmatically  parsing this file, note that:

    - Some lines contain leading spaces, which must be removed before
    counting fields.

    - You should probably be using house-states.txt.bz2 instead


  - Fields 1 and 2 are the prettified version of the time at which the
  house change occurs

  - Field 3 is the planet whose house is changing

  - Field 4 is always the word "ENTERS"

  - Field 5 is the planet's new house

  - Field 6 is whether the planet is entering the house prograde (the
  more frequent behavior) or retrograde.

  - Field 7 is approximately the number of second before or after the
  Unix epoch (1970-01-01 00:00:00 UTC). More specifically, it's
  et+946728000-delta, where et is the ephemeris time and delta is the
  difference between ephemeris time and UTC. For more details see
  bclib.h in https://github.com/barrycarter/bcapps/blob/master/ASTRO
  and http://naif.jpl.nasa.gov/pub/naif/toolkit_docs/C/req/time.html

  - Field 8 is the short form of which planet has entered which
  house. The first character is the planet and the second character is
  the house. For the planets (first character):

    - "S" means Sun
    - "M" means Moon
    - "1" means Mercury
    - "2" means Venus
    - "4" means Mars
    - "5" means Jupiter
    - "6" means Saturn

For the house (second character):

    - "0" means Aries
    - "1" means Taurus
    - "2" means Gemini
    - "3" means Cancer
    - "4" means Leo
    - "5" means Virgo
    - "6" means Libra
    - "7" means Scorpio
    - "8" means Sagittarius 
    - "9" means Capricorn
    - "A" means Aquarius ("A" is the hex form of the number 10)
    - "B" means Pisces ("B" is the hex form of the number 11)

Notice that my numbering scheme starts at 0, so Aries is constellation
0, not constellation 1, and Pisces is constellation 11 ("B"), not
constellation 12.

HOW TO READ house-states.txt.bz2
================================

The first field is the prettified version of the date.

The second field are the houses of the Sun, Moon, Mercury, Venus,
Mars, Jupiter, and Saturn in that order, using house numbers as per
the 2nd character of the 8th field of houses.txt.bz2. By way of
example, "3724416" means:

  - Since the first character is "3", that represents the Sun's
  house. Per the table above, house 3 is Cancer.

  - The second character, "7", is the Moon's house, which, per the
  lookup table, is Scorpio.

  - The third character "2" shows Mercury is in Gemini.

  - The fourth character "4" shows Venus is in Leo.

  - ... and so on.

The third field is equivalent to the 7th field of houses.txt.bz2

OTHER NOTES
===========

TODO: add uranus/netpune/pluto/asteroids maybe

TIMING NOTES (all times from start of program):

52m to reach through Venus
7h20m to reach through Moon
7h56m to reach though Jupiter

12/7/2016 at 13:28 started bc-zodiac
14:20 results through venus
20:48 results though moon
21:24 results through jupiter

timing on babybrighton:

0738 MST when started (not EST)
10:31 EST is when venus ended

note precession of equinoxes and link to my other answer

12^7 theoretical, most often and least often (in this period)

average change per n days, plus per planet change (includes retrograd
except sun/moon)

-479695089600.+86400*468, 479386728000

or 959041382400 seconds = 11100016 days = 30390.8115840845 gregorian years

doing agreement for 2000 w/ astrolog thing?

create README for houses.txt.bz2 and for results of perl script

proleptic greogrian

RUNNING CHECKS:


365.242190402

disclaim barycentricity

http://ssd.jpl.nasa.gov/eph_spans.cgi?id=A explains limits if not using barycenters


TESTS
=====

against https://cafeastrology.com/astrologyof2017horoscopes.html randomly good to the minute

B.C.  9002-APR-16 15:23 MOON ENTERS VIRGO PROGRADE -5785915476 M5+ 150.000002
B.C.  9002-MAR-02 20:51 SUN ENTERS CAPRICORN PROGRADE -5785979948 S9+ -89.999999
B.C.  9002-MAY-16 01:54 MOON ENTERS LIBRA PROGRADE -5785873085 M6+ -179.999984
B.C.  9002-MAY-24 14:49 MOON ENTERS AQUARIUS PROGRADE -5785860790 MA+ -60.000030
B.C.  9002-DEC-24 22:47 MOON ENTERS SAGITTARIUS PROGRADE -5785552152 M8+ -119.999957
B.C.  9002-SEP-02 01:34 SUN ENTERS CANCER PROGRADE -5785716145 S3+ 90.000002
B.C.  9002-MAY-27 00:13 MOON ENTERS PISCES PROGRADE -5785857346 MB+ -30.000042
B.C.  9003-MAR-31 21:19 MOON ENTERS LIBRA PROGRADE -5786463760 M6+ 179.999963
B.C.  9003-DEC-05 03:14 MOON ENTERS SCORPIO PROGRADE -5786106285 M7+ -150.000027
B.C.  9003-MAY-04 15:01 SUN ENTERS PISCES PROGRADE -5786415179 SB+ -29.999999

HORIZONS bingles on above


A.D.  9002-MAY-15 15:12 MOON ENTERS GEMINI PROGRADE 3682889473 M2+ 60.000039
A.D.  9002-SEP-16 15:48 SUN ENTERS LIBRA PROGRADE 3683068069 S6+ -180.000000
A.D.  9003-MAY-05 14:34 MOON ENTERS GEMINI PROGRADE 3683400635 M2+ 59.999945
A.D.  9003-AUG-07 02:02 MOON ENTERS SCORPIO PROGRADE 3683535243 M7+ -149.999956
A.D.  9003-DEC-28 17:58 VENUS ENTERS SAGITTARIUS PROGRADE 3683742119 28+ -119.999998
A.D.  9004-JUN-02 22:06 MOON ENTERS SCORPIO PROGRADE 3683968448 M7+ -150.000055
A.D.  9004-JUL-29 18:39 MOON ENTERS SAGITTARIUS PROGRADE 3684050320 M8+ -120.000021
A.D.  9004-OCT-17 06:20 SUN ENTERS SCORPIO PROGRADE 3684164781 S7+ -149.999998
A.D.  9004-NOV-22 01:54 MOON ENTERS PISCES PROGRADE 3684216355 MB+ -29.999993
A.D.  9004-DEC-06 10:16 MOON ENTERS VIRGO PROGRADE 3684237017 M5+ 149.999985

%% NOTE TO SELF: AD/BC -> CE/BCE

%% TODO: look at all TODO in ~/BCGIT/ASTRO before finalizing answer

%% TODO: revise answer to bc-equi-and-sol if appropriate

https://en.wikipedia.org/wiki/Gregorian_calendar#Accuracy states only one day of drift per 7700 years very different from BOTH my results.....

1h28m to do all for 7 planets in parallel (on brighton, 100 years per
file, 10 procs at a time)

TODO: better testing, notes so far (older version?)

tests for 3000-3100 seem to work fine
for 9000-9100 results are consistently low

