<!DOCTYPE html>
<html><head>

<style type="text/css">
  html { height: 100% }
  body { height: 100%; margin: 0px; padding: 0px }
  #map_canvas { height: 100% }
</style>

<script type="text/javascript"
    src="http://maps.google.com/maps/api/js?sensor=false&libraries=places">
</script>
<script type="text/javascript" src="http://ebay.barrycarter.info/jquery-3.1.1.min.js"></script>
<script type="text/javascript">

var myLatLng, myOptions, map, pt, ap, sun, time;

function updateSunMoon() {
 $.get('http://test.bcinfo3.barrycarter.info/sunfake.pl', handleReply);
}

function handleReply(data) {

 alert(data);
 [body, long1, lat1, time1, long2, lat2, time2] = data.split(',');
 time = new Date().getTime()/1000;
 alert(time);

 // sun.setCenter({lat: lat1, lng: lng1});
 //trigger AJAX request
 //specify callback function(s) to process the result of the request

}

//schedule function to be called every 5s
setInterval(updateSunMoon, 5*1000);

//call it the first time
updateSunMoon();

$(function() {

 myLatLng = new google.maps.LatLng(0,0);
 myOptions={zoom:2,center: myLatLng,mapTypeId: google.maps.MapTypeId.TERRAIN};
 map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);
 pt = new google.maps.LatLng(-20.4043855588674,58.8672755135665);
 ap = new google.maps.LatLng(20.4043855588674,-121.132724486433);
 sun = new google.maps.Marker({position: pt,map: map,
 Icon: "http://test.barrycarter.info/sun.png", title:"Sun"});

});

</script>

</head>

<body>

<div id="map_canvas" style="width:100%; height:100%"></div>

</body>

</html>
