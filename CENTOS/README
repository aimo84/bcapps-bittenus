This document describes my attempt to setup a CentOS-7 system the way
I want it with minimal unnecessary daemons running.

I downloaded and installed
http://isoredirect.centos.org/centos/7/isos/x86_64/CentOS-7-x86_64-Minimal-1511.iso
first

%% TODO: removing things I don't want (TODO: create a "runme.sh" file here)

: confirmed I can reboot after doing this
sudo yum remove audit NetworkManager postfix

: confirmed I can reboot after doing this
sudo yum remove irqbalance tuned

%% TODO: combine removes into single remove

%% TODO: can't remove lvm2, but can I kill after reboot?

%% TODO: attempted kill after boot:

: killing systemd-udevd and systemd-logind works but they come right back
: same with systemd-journald and "agetty"

: TODO: should be able to turn off anacron at a more fundamental level
sudo kill anacron
sudo pkill lvmetad
sudo pkill login
sudo pkill agetty

%% TODO: have yum keepcache set to 1

%% TODO: copy approved repo config files here and then symlink to /etc/yum.repos.d/

%% TODO: currently running "sudo dhclient -d" manually at each reboot, fix

%%%%%%%%% BEGIN COPY FROM FEDORA/README

% OPTIONAL: If you have an encrypted non-boot drive (I'm naming mine
kemptown), do the following (note use your LVM's actual name below--
if you previously tried installing fedora this other drive, your LVMs
will have the same name, which you will have to fix-- see
"lvm-name-conflict.txt" in this directory):

: initially, there is no "/etc/cryptsetup" and "/etc/crypttab" reads:

: luks-id-of-root-partition UUID=id-of-root-partition none

cryptsetup open /dev/sdb3 kemptown
less /etc/cryptsetup
echo "luks /dev/sdb3 -" > /etc/cryptsetup
less /etc/crypttab
blkid | fgrep /dev/sdb3
: this must be an append, since main drive should appear there first
echo "luks UUID=the-uuid-given-by-blkid-for-dev-sdb3 none" >> /etc/crypttab
less /etc/fstab
echo "/dev/mapper/oldfedora-home /mnt/kemptown ext4 defaults,x-systemd.device-timeout=30 60 90" >> /etc/fstab
mkdir /mnt/kemptown
mount /mnt/kemptown

% If you installed Fedora on your large internal drive first and then
tried to move the installation to an SSD drive, the steps above may
not work properly: read lvm-name-conflict.txt in the ../FEDORA/
directory to continue

% create swapspace on /mnt/kemptown/swapspace (TODO: there may be
better ways of doing this but I'm wary of messing w/ my 8TB drive
since I've copied stuff over and made changes)

: only need to do two steps below once
dd if=/dev/zero of=/mnt/kemptown/swap bs=1000000000 count=128 status=progress&
mkswap /mnt/kemptown/swap
: below as recommended
chmod 0600 /mnt/kemptown/swap

less /etc/fstab
echo "/mnt/kemptown/swap swap swap defaults 0 0" >> /etc/fstab
swapon /mnt/kemptown/swap

% OPTIONAL: move user's home to /mnt/kemptown:

: if below reports "userdel: user user is currently used by process
: xxxx", kill process xxxx (potentially repeatedly) until the command
: succeeds

userdel user;
find /home/user -type f
: above should be tiny(ish)
rm -rf /home/user;
useradd -d /mnt/kemptown/user -g wheel -u 1000 user
passwd user
ln -s /mnt/kemptown/user /home
: move root over as well
mv /root /root.old
ln -s /mnt/kemptown/root /root

% OPTIONAL: "shutdown -r now" to make sure everything comes up fine

% mass install (TODO: combine these later, and also "-y")

%% TODO: note that yum skips over uninstallable packages, but deal with those

: this must come first

sudo yum install epel-release

: from https://rpmfusion.org/Configuration

su -c 'yum localinstall --nogpgcheck https://download1.rpmfusion.org/free/el/updates/6/i386/rpmfusion-free-release-6-1.noarch.rpm https://download1.rpmfusion.org/nonfree/el/updates/6/i386/rpmfusion-nonfree-release-6-1.noarch.rpm'

sudo yum upgrade

sudo yum install ImageMagick OpenThreads PySolFC SDL-devel alpine aspell 

sudo yum install audacity bind c++-gtk-utils-gtk2-devel community-mysql 

sudo yum install community-mysql-server dosbox dosemu elinks emacs enscript 

sudo yum install esniper expect feh ffmpeg ftp fuse-encfs fvwm gd-devel 

sudo yum install getmail glade glade-devel gnumeric gnuplot gpm graphviz 

sudo yum install gtk+extra-devel gtk2-devel gtk3-devel html2ps lynx mencoder 

sudo yum install parallel mplayer mrtg nagios-plugins nano ncftp openrdate 

sudo yum install perl-CPAN php-mysqlnd pidgin postgresql postgresql-server

sudo yum install qgis qhull rdesktop recoll rsyslog rxvt samba screen snownews

sudo yum install stella stellarium tcsh tigervnc tk unrtf util-linux-user vice

sudo yum install vlc xdotool xemacs xemacs-packages-extra-el xinetd

sudo yum install xorg-x11-apps xpdf xsane xteddy xterm xv yum yum-utils 

sudo yum install zlib-devel zlib-static mod_ldap tor tor-arm-gui tor-arm 

sudo yum install onionshare privoxy recordmydesktop tmpwatch 

sudo yum install esmtp-local-delivery sendmail sendmail-cf fuse-sshfs fuse-zip

sudo yum install fuse-encfs curlftpfs bindfs xcalc libpuzzle libpuzzle-devel

sudo yum install pyephem python2-astropy python3-astropy erfa libnova ast R

sudo yum install sagemath-notebook nmap p7zip lucene ntpdate

%%% STOP HERE; no rsync on brighton, bad untill END COPY FROM FEDORA/README

% From remote machine, rsync over BCGIT to brighton, since I will use
symlinks to get things in their proper place

\rsync -Pav /home/barrycarter/BCGIT user@brighton:/home/user/

: and rsync over my private crontab, one of the few files not in this directory

\rsync -Pav /home/barrycarter/bc-private-crontab user@brighton:/home/user/

%%%%% END COPY FROM FEDORA/README

%% TODO: copy notes from FEDORA/README as applicable
